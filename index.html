<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Poem Archive & Radio Player for Shamayel</title>
    <style>
        /* --- General Styles --- */
        body {
            font-family: 'Georgia', serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #d0a58f;
            color: #333;
        }

        .header {
            background-color: #5d5c61;
            color: white;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            margin: 0;
            font-family: 'Playfair Display', serif;
        }

        /* --- Radio Player Styles --- */
        .radio-player {
            display: flex;
            align-items: center;
            background-color: #737373;
            padding: 8px 15px;
            border-radius: 5px;
        }

        .radio-player button {
            background-color: #c9c9c9;
            color: #333;
            border: none;
            padding: 8px 12px;
            cursor: pointer;
            border-radius: 3px;
            margin-left: 10px;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        .radio-player button:hover {
            background-color: #fff;
        }

        .container {
            max-width: 1000px;
            margin: 30px auto;
            padding: 0 20px;
        }

        /* --- Poem List Styles --- */
        .poem-list {
            list-style: none;
            padding: 0;
        }

        .poem-item {
            border: 1px solid #ddd;
            margin-bottom: 10px;
            border-radius: 5px;
            overflow: hidden;
            background-color: white;
        }

        .poem-title {
            padding: 15px;
            background-color: #e0e0e0;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.3s;
        }

        .poem-title:hover {
            background-color: #d1d1d1;
        }

        .new-tag {
            background-color: #ff6b6b;
            color: white;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 0.8em;
            margin-left: 10px;
        }

        .poem-content-wrapper {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.7s ease-in-out;
        }

        /* --- Poem Content (Desktop View: Side-by-Side) --- */
        .poem-content {
            display: flex;
            padding: 20px;
        }
        
        .poem-text {
            flex: 1;
            padding-right: 20px;
            padding-left: 20px;
            white-space: pre-wrap; 
        }

        .poem-text pre {
            /* Ensures pre formatting is applied inside the poem-text container */
            white-space: pre-wrap; 
            word-wrap: break-word;
        }

        .poem-image {
            flex-shrink: 0;
            width: 40%;
            display: flex;
            justify-content: center;
            align-items: center;
            /* padding-right: 20px;
            padding-left: 20px; */
        }

        .poem-image img {
            max-width: 100%;
            height: auto;
            border-radius: 5px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            max-height: 250px; 
            object-fit: contain;
        }
        
        /* --- Mobile View Enhancement (max-width: 768px) --- */
        @media (max-width: 768px) {
            /* Header adjustments for mobile */
            .header {
                flex-direction: column; /* Stack title and radio vertically */
                padding: 15px 10px;
            }

            .header h1 {
                text-align: center;
            }
            
            .radio-player {
                /* Center the player horizontally and give it some space */
                margin: 10px auto; 
                padding: 6px 12px;
            }

            /* Poem content adjustments for mobile */
            .poem-content {
                flex-direction: column; /* Stacks items vertically */
            }

            .poem-text {
                width: auto;
                padding: 10px 20px 20px 20px;
            }
            
            .poem-text pre {
                 /* Ensure content wraps freely on small screens */
                white-space: pre-wrap;
                word-wrap: break-word;
            }

            .poem-image {
                /* Full width and moved to the bottom */
                width: 60%; 
                order: 2; 
                padding: 10px 20px 20px 20px;
            }

            .poem-image img {
                max-height: 300px; 
            }
        }
    </style>
</head>
<body>

    <div class="header">
        <h1>ðŸ“œ Songs for Shamayel</h1>
        <div class="radio-player">
            <span>ðŸŽ¶ Bbtoe Radio</span>
            <button id="playPauseButton">Play</button>
            <audio id="radioStream" src="" loop></audio>
        </div>
    </div>

    <div class="container">
        <ul class="poem-list" id="poemList">
            </ul>
    </div>

    <script>
        // --- Poem Data ---
        const poems = [
            {
                name: "Oceans",
                isNew: true,
                poem: `~ By Sartaj Jamal Chowdhury

The moon - a mirror to your smile;
No rigger enchanting enough to paint.
I held your soft hands for a while,
Your  eyes as pure as a fictional saint,
Got me swayed off of the ground, closer to a sky.
                
A sky not from the world I know.
With you in this world, a few realms more,
I wish to stare at you and remain lost
I want the time to stop, but the Sun melts fast every frost.
                
When I forget what life is worth,
I listen to you softly breathe.
Wish we shared our hearts some more;
Before the world put us miles apart, not feet.
                
I walk around a sleeping town,
Moping to not have you by my side.
Hopes to be yours forever and more,
Is the strength that keeps me alive.`,
                image: "https://t4.ftcdn.net/jpg/00/80/60/91/360_F_80609112_wzMi8JnoOz84017J1k7Htfx18DImD4k0.jpg"
            },
            {
                name: "Waves",
                isNew: true,
                poem: `~ By Sartaj Jamal Chowdhury
                
She arrived dust and mud.
Innocuous, yet enchanting.
Her boat shall leave,
And so will my heart.

Yet I tread near almost crawling,
Minutes to days to weeks.
Faster than a Jackal, the time leaps.
All my soul keeps unfurling..

I couldn't wait but stood still to stare-
Ocean waves that break but silence;
The silence is louder, yet unheard.
Wish i did not hearken.

Wish I did not pay attention.
To the darkness that rose above;
Tearing us apart.
Every drop of agony..

Agony as loud as a storm;
Yet unheard.. 
Unheard by the fear etched hearts.
No streams shall ever stop to ebb..

Her smile embarked the bay,
The bay of a box named soul..
It will forever stay,
To be human is to slowly mould.

Her warmth a summer breeze.
The hearth in a winter freeze.
A golden hue in a dreamy fall.
The spring garden of flowers that waltz.

We crossed paths for a minute span,
A glimpse of life in a no man's land.
Short lived we were lines of fallen paths..
The patterns of love, maybe merely a glass of sand.`,
                image: "https://images.ft.com/v3/image/raw/ftcms%3A37c41f1f-307d-4ca1-9c2c-b2cf5afd70cb?source=next-article&fit=scale-down&quality=highest&width=1440&dpr=1"
           },
           {
                name: "Under Construction",
                isNew: false,
                poem: `Work in prog`,
                image: "https://t4.ftcdn.net/jpg/09/99/09/89/360_F_999098968_sVwBgteezt2zfvoleGetnuzj04BSTVE1.jpg"
            }
        ];

        // --- Poem Archive Logic ---
        const poemListElement = document.getElementById('poemList');

        function renderPoems() {
            poems.forEach((poem, index) => {
                const listItem = document.createElement('li');
                listItem.className = 'poem-item';

                // Poem Title (Clickable)
                const titleDiv = document.createElement('div');
                titleDiv.className = 'poem-title';
                titleDiv.setAttribute('data-index', index);
                titleDiv.innerHTML = `${poem.name} ${poem.isNew ? '<span class="new-tag">[New]</span>' : ''}`;
                
                // Poem Content (Dropdown)
                const contentWrapper = document.createElement('div');
                contentWrapper.className = 'poem-content-wrapper';
                contentWrapper.id = `content-${index}`;

                const contentDiv = document.createElement('div');
                contentDiv.className = 'poem-content';
                
                // Use <pre> tag to preserve original line breaks and spaces
                const poemText = document.createElement('pre'); 
                poemText.className = 'poem-text';
                poemText.textContent = poem.poem;
                
                const poemImage = document.createElement('div');
                poemImage.className = 'poem-image';
                poemImage.innerHTML = `<img src="${poem.image}" alt="${poem.name}">`;

                contentDiv.appendChild(poemText);
                contentDiv.appendChild(poemImage);
                contentWrapper.appendChild(contentDiv);

                listItem.appendChild(titleDiv);
                listItem.appendChild(contentWrapper);
                poemListElement.appendChild(listItem);
            });
        }

        function togglePoem(event) {
            const titleElement = event.currentTarget;
            const index = titleElement.getAttribute('data-index');
            const contentWrapper = document.getElementById(`content-${index}`);

            if (contentWrapper.style.maxHeight === '0px' || contentWrapper.style.maxHeight === '') {
                contentWrapper.style.maxHeight = contentWrapper.scrollHeight + "px";
            } else {
                contentWrapper.style.maxHeight = '0px';
            }
        }

        // Attach event listeners after rendering
        window.onload = () => {
            renderPoems();
            document.querySelectorAll('.poem-title').forEach(title => {
                title.addEventListener('click', togglePoem);
            });
            initializeRadioPlayer();
        };

        // --- Radio Player Logic (Radio Browser API) ---
        const radioStream = document.getElementById('radioStream');
        const playPauseButton = document.getElementById('playPauseButton');
        let currentStreamUrl = '';

        async function getRadioStation() {
            try {
                // Find a random server for the API
                const serverResponse = await fetch('https://all.api.radio-browser.info/json/servers');
                const servers = await serverResponse.json();
                const server = servers[Math.floor(Math.random() * servers.length)];
                
                // Search by 'soft rock' tag
                const apiUrl = `https://${server.name}/json/stations/bytag/soft%20rock`;

                // Fetch a list of stations
                const stationsResponse = await fetch(apiUrl);
                const stations = await stationsResponse.json();

                if (stations && stations.length > 0) {
                    // Select a random station
                    const randomStation = stations[Math.floor(Math.random() * stations.length)];
                    let resolvedUrl = randomStation.url_resolved || randomStation.url;
                    
                    // CRITICAL FIX: Force stream URL to use HTTPS to avoid Mixed Content Error on GitHub Pages
                    currentStreamUrl = resolvedUrl.replace("http://", "https://");
                    
                    radioStream.src = currentStreamUrl;
                    console.log("Found Radio Station:", randomStation.name, "Stream URL:", currentStreamUrl);
                } else {
                    console.error("No radio stations found for the tag 'soft rock'.");
                }
            } catch (error) {
                console.error("Error fetching radio stations:", error);
            }
        }

        function initializeRadioPlayer() {
            getRadioStation(); 

            playPauseButton.addEventListener('click', () => {
                if (radioStream.paused) {
                    if (!radioStream.src || radioStream.src === window.location.href) {
                        getRadioStation();
                    }
                    radioStream.play().then(() => {
                        playPauseButton.textContent = 'Pause';
                    }).catch(e => {
                        console.error("Error playing radio stream. Ensure the stream is accessible over HTTPS.", e);
                        playPauseButton.textContent = 'Play (Error)';
                    });
                } else {
                    radioStream.pause();
                    playPauseButton.textContent = 'Play';
                }
            });

            radioStream.addEventListener('error', () => {
                console.error("Audio playback error. The stream may be broken or inaccessible via HTTPS.");
                playPauseButton.textContent = 'Play (Failed)';
            });
        }
    </script>

</body>
</html>